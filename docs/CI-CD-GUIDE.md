# DesktopPet CI/CD æŒç»­é›†æˆæŒ‡å—

## ðŸ“‹ ç›®å½•
- [CI/CD æ¦‚è¿°](#cicd-æ¦‚è¿°)
- [åˆ†æ”¯ç®¡ç†ç­–ç•¥](#åˆ†æ”¯ç®¡ç†ç­–ç•¥)
- [å·¥ä½œæµç¨‹è¯´æ˜Ž](#å·¥ä½œæµç¨‹è¯´æ˜Ž)
- [å¦‚ä½•ä½¿ç”¨ CI/CD](#å¦‚ä½•ä½¿ç”¨-cicd)
- [æ•…éšœæŽ’é™¤](#æ•…éšœæŽ’é™¤)
- [æœ€ä½³å®žè·µ](#æœ€ä½³å®žè·µ)

## ðŸ”„ CI/CD æ¦‚è¿°

### ä»€ä¹ˆæ˜¯ CI/CDï¼Ÿ
**æŒç»­é›†æˆï¼ˆCIï¼‰**ï¼šå¼€å‘è€…é¢‘ç¹åœ°å°†ä»£ç é›†æˆåˆ°ä¸»å¹²ï¼Œæ¯æ¬¡é›†æˆéƒ½é€šè¿‡è‡ªåŠ¨åŒ–æž„å»ºå’Œæµ‹è¯•æ¥éªŒè¯ã€‚
**æŒç»­éƒ¨ç½²ï¼ˆCDï¼‰**ï¼šè‡ªåŠ¨åŒ–åœ°å°†å·²éªŒè¯çš„ä»£ç éƒ¨ç½²åˆ°ç”Ÿäº§çŽ¯å¢ƒã€‚

### æˆ‘ä»¬çš„ CI/CD æµæ°´çº¿åŒ…å«
- âœ… **è‡ªåŠ¨æž„å»º**ï¼šå¤šå¹³å°ï¼ˆWindows/Linux/macOSï¼‰
- âœ… **è‡ªåŠ¨æµ‹è¯•**ï¼šå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•
- âœ… **ä»£ç è´¨é‡æ£€æŸ¥**ï¼šé™æ€åˆ†æžã€æ ¼å¼æ£€æŸ¥
- âœ… **å®‰å…¨æ‰«æ**ï¼šæ¼æ´žæ£€æµ‹ã€ä¾èµ–å®‰å…¨æ£€æŸ¥
- âœ… **æ€§èƒ½æµ‹è¯•**ï¼šæž„å»ºæ€§èƒ½ã€è¿è¡Œæ—¶æµ‹è¯•
- âœ… **è‡ªåŠ¨å‘å¸ƒ**ï¼šæ ‡ç­¾å‘å¸ƒã€èµ„äº§ç®¡ç†

## ðŸŒ¿ åˆ†æ”¯ç®¡ç†ç­–ç•¥

### åˆ†æ”¯ç±»åž‹
```text
main (ä¸»åˆ†æ”¯)
â”œâ”€â”€ feature/feature-name (åŠŸèƒ½åˆ†æ”¯)
â”œâ”€â”€ hotfix/fix-name (çƒ­ä¿®å¤åˆ†æ”¯)
â”œâ”€â”€ release/version-name (å‘å¸ƒåˆ†æ”¯)
â””â”€â”€ develop (å¼€å‘åˆ†æ”¯ï¼Œå¯é€‰)
```

### åˆ†æ”¯å‘½åè§„èŒƒ
- `feature/` - æ–°åŠŸèƒ½å¼€å‘
- `bugfix/` - é—®é¢˜ä¿®å¤
- `hotfix/` - ç´§æ€¥ä¿®å¤
- `release/` - å‘å¸ƒå‡†å¤‡
- `docs/` - æ–‡æ¡£æ›´æ–°
- `test/` - æµ‹è¯•ç›¸å…³

### ä¿æŠ¤åˆ†æ”¯è®¾ç½®
- `main` åˆ†æ”¯ï¼šéœ€è¦ PR å®¡æŸ¥ï¼ŒCI é€šè¿‡åŽæ‰èƒ½åˆå¹¶
- ä¸å…è®¸ç›´æŽ¥æŽ¨é€åˆ° `main` åˆ†æ”¯
- éœ€è¦çº¿æ€§åŽ†å²è®°å½•ï¼ˆsquash mergeï¼‰

## ðŸš€ å·¥ä½œæµç¨‹è¯´æ˜Ž

### 1. å¿«é€Ÿæ£€æŸ¥ï¼ˆPR æ—¶è§¦å‘ï¼‰
```yaml
# .github/workflows/quick-test.yml
on: [pull_request]
jobs:
  - ä»£ç æ ¼å¼æ£€æŸ¥
  - åŸºç¡€ç¼–è¯‘æ£€æŸ¥
  - å•å…ƒæµ‹è¯•
  - ä»£ç è¦†ç›–çŽ‡
```

### 2. å®Œæ•´ CIï¼ˆPush åˆ° main æ—¶è§¦å‘ï¼‰
```yaml
# .github/workflows/ci.yml
on: 
  push:
    branches: [main]
jobs:
  - å¤šå¹³å°æž„å»º
  - å®Œæ•´æµ‹è¯•å¥—ä»¶
  - æ€§èƒ½æµ‹è¯•
  - æ–‡æ¡£ç”Ÿæˆ
```

### 3. å®‰å…¨æ‰«æï¼ˆå®šæœŸ + PR æ—¶è§¦å‘ï¼‰
```yaml
# .github/workflows/security.yml
schedule:
  - cron: '0 2 * * 1' # æ¯å‘¨ä¸€å‡Œæ™¨2ç‚¹
jobs:
  - ä¾èµ–æ¼æ´žæ‰«æ
  - é™æ€ä»£ç å®‰å…¨åˆ†æž
  - é•œåƒå®‰å…¨æ‰«æ
```

### 4. å‘å¸ƒæµç¨‹ï¼ˆTag æ—¶è§¦å‘ï¼‰
```yaml
# .github/workflows/release.yml
on:
  push:
    tags: ['v*']
jobs:
  - æž„å»ºå‘å¸ƒç‰ˆæœ¬
  - åˆ›å»º GitHub Release
  - ä¸Šä¼ æž„å»ºäº§ç‰©
```

## ðŸ› ï¸ å¦‚ä½•ä½¿ç”¨ CI/CD

### æ­¥éª¤ 1ï¼šåˆ›å»ºåŠŸèƒ½åˆ†æ”¯
```bash
# ä»Ž main åˆ†æ”¯åˆ›å»ºæ–°åˆ†æ”¯
git checkout main
git pull origin main
git checkout -b feature/my-new-feature
```

### æ­¥éª¤ 2ï¼šå¼€å‘å’Œæäº¤
```bash
# è¿›è¡Œå¼€å‘å·¥ä½œ
# æäº¤æ›´æ”¹
git add .
git commit -m "feat: add new feature"

# æŽ¨é€åˆ°è¿œç¨‹åˆ†æ”¯
git push origin feature/my-new-feature
```

### æ­¥éª¤ 3ï¼šåˆ›å»º Pull Request
1. åœ¨ GitHub ä¸Šåˆ›å»º PR
2. ç­‰å¾… CI æ£€æŸ¥é€šè¿‡
3. è¯·æ±‚ä»£ç å®¡æŸ¥
4. ä¿®å¤ä»»ä½• CI å¤±è´¥çš„é—®é¢˜

### æ­¥éª¤ 4ï¼šåˆå¹¶åˆ°ä¸»åˆ†æ”¯
```bash
# PR åˆå¹¶åŽï¼Œæ¸…ç†æœ¬åœ°åˆ†æ”¯
git checkout main
git pull origin main
git branch -d feature/my-new-feature
```

### æ­¥éª¤ 5ï¼šåˆ›å»ºå‘å¸ƒ
```bash
# åˆ›å»ºå‘å¸ƒæ ‡ç­¾
git tag -a v1.0.0 -m "Release version 1.0.0"
git push origin v1.0.0
```

## ðŸ”§ æœ¬åœ°å¼€å‘çŽ¯å¢ƒè®¾ç½®

### è¿è¡Œ CI æ£€æŸ¥è„šæœ¬
```bash
# Windows
.\check-ci-setup.bat

# Linux/macOS
./check-ci-setup.sh
```

### æœ¬åœ°æž„å»ºéªŒè¯
```bash
# ä½¿ç”¨ CMake é¢„è®¾
cmake --preset=mingw
cmake --build --preset=mingw

# è¿è¡Œæµ‹è¯•
ctest --preset=mingw
```

## ðŸ” CI/CD ç›‘æŽ§å’Œè°ƒè¯•

### æŸ¥çœ‹æž„å»ºçŠ¶æ€
- åœ¨ GitHub Actions æ ‡ç­¾é¡µæŸ¥çœ‹å·¥ä½œæµè¿è¡Œæƒ…å†µ
- ç‚¹å‡»å…·ä½“çš„å·¥ä½œæµæŸ¥çœ‹è¯¦ç»†æ—¥å¿—
- æŸ¥çœ‹æž„å»ºäº§ç‰©å’Œæµ‹è¯•æŠ¥å‘Š

### å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

#### é—®é¢˜ 1ï¼šæž„å»ºå¤±è´¥
```bash
# æ£€æŸ¥æž„å»ºæ—¥å¿—
# å¸¸è§åŽŸå› ï¼šä¾èµ–ç¼ºå¤±ã€çŽ¯å¢ƒé…ç½®é—®é¢˜
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ CMakeLists.txt é…ç½®
2. ç¡®ä¿æ‰€æœ‰ä¾èµ–éƒ½åœ¨ setup-dev-env.bat ä¸­å®‰è£…
3. æ£€æŸ¥å¹³å°ç‰¹å®šçš„æž„å»ºé…ç½®

#### é—®é¢˜ 2ï¼šæµ‹è¯•å¤±è´¥
```bash
# æœ¬åœ°è¿è¡Œæµ‹è¯•
ctest --preset=mingw --verbose
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®ä¿æ‰€æœ‰æµ‹è¯•åœ¨æœ¬åœ°é€šè¿‡
2. æ£€æŸ¥æµ‹è¯•æ•°æ®å’Œèµ„æºæ–‡ä»¶
3. æ£€æŸ¥å¹³å°ç‰¹å®šçš„æµ‹è¯•é…ç½®

#### é—®é¢˜ 3ï¼šå®‰å…¨æ‰«æå‘Šè­¦
**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ›´æ–°æœ‰æ¼æ´žçš„ä¾èµ–
2. ä¿®å¤ä»£ç ä¸­çš„å®‰å…¨é—®é¢˜
3. å¦‚æžœæ˜¯è¯¯æŠ¥ï¼Œåœ¨é…ç½®ä¸­æ·»åŠ ä¾‹å¤–

#### é—®é¢˜ 4ï¼šæ€§èƒ½æµ‹è¯•å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥æ€§èƒ½åŸºå‡†è®¾ç½®
2. ä¼˜åŒ–ä»£ç æ€§èƒ½
3. è°ƒæ•´æ€§èƒ½æµ‹è¯•çš„é˜ˆå€¼

## ðŸ“Š CI/CD æŒ‡æ ‡ç›‘æŽ§

### å…³é”®æŒ‡æ ‡
- **æž„å»ºæˆåŠŸçŽ‡**ï¼š>95%
- **æµ‹è¯•è¦†ç›–çŽ‡**ï¼š>80%
- **æž„å»ºæ—¶é—´**ï¼š<10åˆ†é’Ÿ
- **éƒ¨ç½²é¢‘çŽ‡**ï¼šæ¯å‘¨è‡³å°‘1æ¬¡
- **æ•…éšœæ¢å¤æ—¶é—´**ï¼š<1å°æ—¶

### ç›‘æŽ§å·¥å…·
- GitHub Actions å†…ç½®ç»Ÿè®¡
- æž„å»ºæ—¶é—´è¶‹åŠ¿
- æµ‹è¯•è¦†ç›–çŽ‡æŠ¥å‘Š
- æ€§èƒ½åŸºå‡†æµ‹è¯•

## ðŸŽ¯ æœ€ä½³å®žè·µ

### ä»£ç æäº¤
- ä½¿ç”¨çº¦å®šå¼æäº¤ï¼ˆConventional Commitsï¼‰
- æ¯æ¬¡æäº¤åº”è¯¥æ˜¯ä¸€ä¸ªé€»è¾‘å®Œæ•´çš„æ›´æ”¹
- æäº¤ä¿¡æ¯è¦æ¸…æ™°æè¿°æ›´æ”¹å†…å®¹

### åˆ†æ”¯ç®¡ç†
- ä¿æŒåˆ†æ”¯ç”Ÿå‘½å‘¨æœŸçŸ­
- åŠæ—¶åˆå¹¶åˆ°ä¸»åˆ†æ”¯
- åˆ é™¤å·²åˆå¹¶çš„åˆ†æ”¯

### æµ‹è¯•ç­–ç•¥
- ç¼–å†™å•å…ƒæµ‹è¯•è¦†ç›–æ ¸å¿ƒåŠŸèƒ½
- é›†æˆæµ‹è¯•éªŒè¯ç»„ä»¶äº¤äº’
- æ€§èƒ½æµ‹è¯•ç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§

### å®‰å…¨è€ƒè™‘
- ä¸åœ¨ä»£ç ä¸­ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯
- å®šæœŸæ›´æ–°ä¾èµ–
- ä½¿ç”¨å®‰å…¨çš„ç¼–ç å®žè·µ

## ðŸ“š å»¶ä¼¸é˜…è¯»

- [GitHub Actions æ–‡æ¡£](https://docs.github.com/en/actions)
- [CMake æœ€ä½³å®žè·µ](https://cmake.org/cmake/help/latest/guide/tutorial/index.html)
- [Qt6 CI/CD æŒ‡å—](https://doc.qt.io/qt-6/cmake-get-started.html)
- [C++ æµ‹è¯•æœ€ä½³å®žè·µ](https://github.com/google/googletest)

## ðŸ†˜ èŽ·å–å¸®åŠ©

å¦‚æžœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹ GitHub Actions æ—¥å¿—
2. æ£€æŸ¥ CI-CD-DEPLOYMENT-GUIDE.md
3. è¿è¡Œæœ¬åœ°æ£€æŸ¥è„šæœ¬
4. åœ¨å›¢é˜ŸèŠå¤©ä¸­å¯»æ±‚å¸®åŠ©

---

*è¿™ä¸ªæŒ‡å—ä¼šéšç€é¡¹ç›®çš„å‘å±•è€Œæ›´æ–°ã€‚å¦‚æžœæ‚¨æœ‰ä»»ä½•å»ºè®®æˆ–å‘çŽ°é—®é¢˜ï¼Œè¯·åˆ›å»º Issue æˆ– PRã€‚*
